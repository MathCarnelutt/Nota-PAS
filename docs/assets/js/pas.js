function ativarCursos(){$(".form-serie").on("change",function(){"3ano"==$(this).val()?$(".form-curso").removeAttr("disabled"):$(".form-curso").attr("disabled","true")})}function setInputs(){for(var a=1;a<=40;a++)$('input.questao[name="qst-'+a+'"]').val(params["qst-"+a]);$('option[value="'+serie+'"]').attr("selected","selected").siblings().removeAttr("selected"),"3ano"==serie&&($(".form-curso").removeAttr("disabled"),$('option[value="'+curso+'"]').attr("selected","selected").siblings().removeAttr("selected")),$('option[value="'+linguaEstrangeira+'"]').attr("selected","selected").siblings().removeAttr("selected"),$('option[value="'+ano+'"]').attr("selected","selected").siblings().removeAttr("selected"),$('input[name="redacao"]').val(redacao)}function setVariables(){for(var a=1;a<=40;a++)questoesMarcadas.push(parseInt(params["qst-"+a],10));questoesCorretas=questoesCorretas.concat(_gabarito[ano][serie]["conhecimentos-gerais"]),questoesCorretas=questoesCorretas.concat(_gabarito[ano][serie]["portugues-literatura"]),questoesCorretas=questoesCorretas.concat(_gabarito[ano][serie][linguaEstrangeira]),"3ano"==serie&&(questoesCorretas=questoesCorretas.concat(_gabarito[ano][serie][especificas[0]]),questoesCorretas=questoesCorretas.concat(_gabarito[ano][serie][especificas[1]]))}function calculaNota(){for(var a=[],e=0,s=0,t=0,o="",r=[],i=0;i<questoesMarcadas.length;i++){var c=getNota(questoesMarcadas[i],questoesCorretas[i]);a.push(c),e+=c,c>0&&t++}s=e+redacao;var u=_categorias[ano][serie];r=[["Conhecimentos Gerais",u["conhecimentos-gerais"][0],u["conhecimentos-gerais"][1]],["Português e Literatura",u["portugues-literatura"][0],u["portugues-literatura"][1]],["Língua Estrangeira - "+pretty(linguaEstrangeira),u["lingua-estrangeira"][0],u["lingua-estrangeira"][1]]],"3ano"==serie&&(r[3]=["Específica 1 - "+pretty(especificas[0]),u["especifica-1"][0],u["especifica-1"][1]],r[4]=["Específica 2 - "+pretty(especificas[1]),u["especifica-2"][0],u["especifica-2"][1]]);for(i=0;i<r.length;i++){for(var l=0,p=6*(r[i][2]-r[i][1]+1),d=r[i][1];d<=r[i][2];d++)l+=a[d];l=l.toString().replace(".",","),r[i][0]+=0==l?"<span class='reprovado'>Reprovou</span>":l==p?"<span class='gabaritado'>Gabaritou (Total: "+l+")</span>":"<span class='nota'>Total: "+l+"</span>"}o+="<tbody>";for(var g,i=0;i<r.length;i++){o+='<tr><th colspan="5" scope="colgroup">'+r[i][0]+"</th></tr>",g=0;for(d=r[i][1];d<=r[i][2];d++)d!=r[i][1]&&d!=r[i][1]+5*g||(o+="<tr>",g++),-1==questoesCorretas[d]?o+='<td class="questao-anulada"><span>'+n(d+1)+"</span> </td>":o+="<td><span>"+n(d+1)+"</span> "+nota(a[d])+"</td>",d!=r[i][2]&&d!=r[i][1]+5*g-1||(o+="</tr>")}o+="</tbody>",o+="<tfoot>",o+='<tr><td colspan="5"></td></tr>',o+="<tr>",-1!=questoesCorretas.indexOf(-1)?o+='<td colspan="2" rowspan="2" class="anulada-aviso">*Questões anuladas valem 6 pontos.</td>':o+='<td colspan="2" rowspan="2"></td>',o+='<th colspan="2">Não Zeradas</th>',o+="<td>"+t+"</td>",o+="</tr>",o+="<tr>",o+='<th colspan="2">Zeradas</th>',o+="<td>"+(40-t)+"</td>",o+="</tr>",o+="</tfoot>",$(".tabela-questoes").html(o),$(".notas-resumo .nota-total span").text(nota(s)+" / 360"),$(".notas-resumo .nota-objetivas span").text(nota(e)+" / 240"),$(".notas-resumo .nota-redacao span").text(nota(redacao)+" / 120"),$("section.notas").css("display","block")}function showTooltips(){$(".tooltip-wrap").children().first().on("focus",function(){$(".tooltip-wrap .tooltip").addClass("show")}),$(".tooltip-wrap").children().first().on("blur",function(){$(".tooltip-wrap .tooltip").removeClass("show")})}var questoesCorretas=[],questoesMarcadas=[],serie,linguaEstrangeira,redacao,ano,curso,especificas,_gabarito,_especificas,_categorias,params,version=Math.floor(1e3*Math.random()+1);$(function(){$.getJSON("./../assets/js/gabPas.json?v="+version,function(a){_gabarito=a.gabarito,_especificas=a.especificas,_categorias=a.categorias,ativarCursos(),"true"==(params=getParams()).calcular&&(serie=params.serie,linguaEstrangeira=params["lingua-estrangeira"],redacao=Number(params.redacao),ano=params.ano,"3ano"==serie&&(curso=params.curso,especificas=_especificas[curso]),setInputs(),setVariables(),calculaNota()),showTooltips()})});